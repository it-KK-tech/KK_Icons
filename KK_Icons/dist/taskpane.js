/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,n,t){e.exports=t.p+"b6eb2edf827ed3783ed6.css"}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={exports:{}};return e[r](i,i.exports,t),i.exports}t.m=e,t.d=function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/",t.b=document.baseURI||self.location.href,function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(){var e,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(n,o,i,a){var c=o&&o.prototype instanceof l?o:l,u=Object.create(c.prototype);return t(u,"_invoke",function(n,t,o){var i,a,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return i=n,a=0,c=e,f.n=t,s}};function p(n,t){for(a=n,c=t,r=0;!d&&l&&!o&&r<u.length;r++){var o,i=u[r],p=f.p,m=i[2];n>3?(o=m===t)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(a=0,f.v=t,f.n=i[1]):p<m&&(o=n<3||i[0]>t||t>m)&&(i[4]=n,i[5]=t,f.n=m,a=0))}if(o||n>1)return s;throw d=!0,t}return function(o,u,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,m),a=u,c=m;(r=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((r=(d=f.n<0)?c:n.call(t,f))!==s)break}catch(n){i=e,a=1,c=n}finally{l=1}}return{value:r,done:d}}}(n,i,a),!0),u}var s={};function l(){}function u(){}function d(){}r=Object.getPrototypeOf;var f=[][i]?r(r([][i]())):(t(r={},i,function(){return this}),r),p=d.prototype=l.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,t(p,"constructor",d),t(d,"constructor",u),u.displayName="GeneratorFunction",t(d,a,"GeneratorFunction"),t(p),t(p,a,"Generator"),t(p,i,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:c,m:m}})()}function t(e,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,r,o){function a(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?i?i(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},t(e,n,r,o)}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,a,c=[],s=!0,l=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=i.call(t)).done)&&(c.push(r.value),c.length!==n);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,n)||function(e,n){if(e){if("string"==typeof e)return o(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function i(e,n,t,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(r,o)}function a(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function c(e){i(a,r,o,c,s,"next",e)}function s(e){i(a,r,o,c,s,"throw",e)}c(void 0)})}}function c(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var r=t.call(n,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}var l,u={baseUrl:"/api/streamline"},d=1,f=!1;Office.onReady(function(e){var n;e.host===Office.HostType.PowerPoint&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",n=document.getElementById("icon-search"),b(0,""),m(),n.addEventListener("input",function(){clearTimeout(l),l=window.setTimeout(function(){y()},500)}),n.addEventListener("keypress",function(e){"Enter"===e.key&&(clearTimeout(l),y())}))});var p=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"makeRequest",value:(s=a(n().m(function e(t){var o,i,a,c,s=arguments;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return o=s.length>1&&void 0!==s[1]?s[1]:{},i=u.baseUrl.startsWith("/")?new URL("".concat(u.baseUrl).concat(t),window.location.origin):new URL("".concat(u.baseUrl).concat(t)),Object.entries(o).forEach(function(e){var n=r(e,2),t=n[0],o=n[1];o&&i.searchParams.append(t,o)}),e.p=1,e.n=2,fetch(i.toString(),{method:"GET",headers:{accept:"application/json"}});case 2:if((a=e.v).ok){e.n=5;break}if(401!==a.status){e.n=3;break}throw new Error("Invalid API key. Please check your Streamline API credentials.");case 3:if(429!==a.status){e.n=4;break}throw new Error("Rate limit exceeded. Please wait a moment before searching again.");case 4:throw new Error("API request failed: ".concat(a.status," ").concat(a.statusText));case 5:return e.n=6,a.json();case 6:return e.a(2,e.v);case 7:if(e.p=7,c=e.v,console.error("Fetch error details:",c),!(c instanceof TypeError)){e.n=8;break}if(!(c.message.includes("fetch")||c.message.includes("NetworkError")||c.message.includes("Failed to fetch"))){e.n=8;break}throw new Error("CORS/Network error: The Streamline API is blocking requests from Office Add-ins. This is a common issue where the API server doesn't allow cross-origin requests from Office domains. URL attempted: ".concat(i.toString()));case 8:throw c;case 9:return e.a(2)}},e,null,[[1,7]])})),function(e){return s.apply(this,arguments)})},{key:"searchFamily",value:(i=a(n().m(function e(t,r){var o,i,a=arguments;return n().w(function(e){for(;;)switch(e.n){case 0:return o=a.length>3&&void 0!==a[3]?a[3]:50,i={page:(a.length>2&&void 0!==a[2]?a[2]:1).toString(),per_page:o.toString()},r&&(i.query=r),e.n=1,this.makeRequest("/search/family/".concat(t),i);case 1:return e.a(2,e.v)}},e,this)})),function(e,n){return i.apply(this,arguments)})},{key:"downloadIconSVG",value:(o=a(n().m(function e(t){var r,o;return n().w(function(e){for(;;)switch(e.n){case 0:return r=u.baseUrl.startsWith("/")?"".concat(window.location.origin).concat(u.baseUrl,"/icons/").concat(t,"/download/svg?size=48&responsive=false"):"".concat(u.baseUrl,"/icons/").concat(t,"/download/svg?size=48&responsive=false"),e.n=1,fetch(r,{headers:{accept:"image/svg+xml"}});case 1:if((o=e.v).ok){e.n=2;break}throw new Error("Failed to download SVG: ".concat(o.status));case 2:return e.n=3,o.text();case 3:return e.a(2,e.v)}},e)})),function(e){return o.apply(this,arguments)})}],t&&c(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,o,i,s}();function m(){document.getElementById("icons-grid").innerHTML='\n    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #605e5c;">\n      <div style="font-size: 16px;">Type a search term to find icons</div>\n    </div>\n  '}function y(){return v.apply(this,arguments)}function v(){return(v=a(n().m(function e(){var t,r,o,i,a,c;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!f){e.n=1;break}return e.a(2);case 1:if(t=document.getElementById("icon-search"),r=document.getElementById("loading-spinner"),o=document.getElementById("icons-grid"),i=t.value.trim()){e.n=2;break}return m(),e.a(2);case 2:return f=!0,d=1,r.style.display="flex",o.style.display="none",e.p=3,e.n=4,p.searchFamily("streamline-light",i,d);case 4:h((a=e.v).results.map(function(e){return{hash:e.hash,name:e.name,family:e.familySlug,category:e.categoryName||e.familyName,tags:[],svgUrl:e.imagePreviewUrl}})),b(a.pagination.total,void 0,Math.floor(a.pagination.offset/50)+1,Math.ceil(a.pagination.total/50)),e.n=6;break;case 5:e.p=5,c=e.v,console.error("Search error:",c),g(c.message||"Failed to search icons. Please try again.");case 6:return e.p=6,f=!1,r.style.display="none",o.style.display="grid",e.f(6);case 7:return e.a(2)}},e,null,[[3,5,6,7]])}))).apply(this,arguments)}function h(e){var n=document.getElementById("icons-grid");0!==e.length?n.innerHTML=e.map(function(e){return'\n    <div class="icon-item" onclick="insertStreamlineIcon(\''.concat(e.hash,"', '").concat(e.name,'\')" title="Click to copy ').concat(e.name,' to clipboard">\n      <div class="icon-symbol" data-icon-hash="').concat(e.hash,'">\n        ').concat(e.svgUrl?'<img src="'.concat(e.svgUrl,'" alt="').concat(e.name,'" />'):'<div class="icon-placeholder">üìÑ</div>',"\n      </div>\n    </div>\n  ")}).join(""):n.innerHTML='\n      <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #605e5c;">\n        <div style="font-size: 48px; margin-bottom: 16px;">üîç</div>\n        <div style="font-size: 16px; margin-bottom: 8px;">No icons found</div>\n        <div style="font-size: 14px;">Try different search terms or browse icon families</div>\n      </div>\n    '}function g(e){document.getElementById("icons-grid").innerHTML='\n    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #d13438;">\n      <div style="font-size: 48px; margin-bottom: 16px;">‚ö†Ô∏è</div>\n      <div style="font-size: 16px; margin-bottom: 8px; font-weight: 600;">Error</div>\n      <div style="font-size: 14px; max-width: 300px; margin: 0 auto; line-height: 1.4;">'.concat(e,"</div>\n    </div>\n  ")}function b(e,n,t,r){var o=document.getElementById("results-count");if(n)o.textContent=n;else if(0===e)o.textContent="No icons found";else if(1===e)o.textContent="1 icon found";else{var i="".concat(e.toLocaleString()," icons found");t&&r&&(i+=" (Page ".concat(t," of ").concat(r,")")),o.textContent=i}}function w(){return(w=a(n().m(function e(t,r){var o,i,a,c;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,p.downloadIconSVG(t);case 1:return o=e.v,e.p=2,i=new Blob([o],{type:"image/svg+xml"}),e.n=3,navigator.clipboard.write([new ClipboardItem({"image/svg+xml":i,"text/plain":new Blob([o],{type:"text/plain"})})]);case 3:x("".concat(r," SVG icon copied to clipboard! Press Ctrl+V to paste in PowerPoint.")),e.n=6;break;case 4:return e.p=4,a=e.v,console.error("Advanced clipboard copy failed, trying simple text copy:",a),e.n=5,navigator.clipboard.writeText(o);case 5:x("".concat(r," SVG copied as text to clipboard! Press Ctrl+V to paste."));case 6:e.n=8;break;case 7:e.p=7,c=e.v,console.error("Error copying icon:",c),k(c.message||"Failed to copy icon. Please try again.");case 8:return e.a(2)}},e,null,[[2,4],[0,7]])}))).apply(this,arguments)}function x(e){var n=document.createElement("div");n.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #107c10;\n    color: white;\n    padding: 12px 16px;\n    border-radius: 4px;\n    font-size: 14px;\n    z-index: 1000;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    animation: slideIn 0.3s ease-out;\n  ",n.textContent=e;var t=document.createElement("style");t.textContent="\n    @keyframes slideIn {\n      from { transform: translateX(100%); opacity: 0; }\n      to { transform: translateX(0); opacity: 1; }\n    }\n  ",document.head.appendChild(t),document.body.appendChild(n),setTimeout(function(){n.parentNode&&document.body.removeChild(n),t.parentNode&&document.head.removeChild(t)},3e3)}function k(e){var n=document.createElement("div");n.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #d13438;\n    color: white;\n    padding: 12px 16px;\n    border-radius: 4px;\n    font-size: 14px;\n    z-index: 1000;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    animation: slideIn 0.3s ease-out;\n  ",n.textContent=e,document.body.appendChild(n),setTimeout(function(){n.parentNode&&document.body.removeChild(n)},4e3)}window.insertStreamlineIcon=function(e,n){return w.apply(this,arguments)}}(),new URL(t(58394),t.b)}();
//# sourceMappingURL=taskpane.js.map